(this.webpackJsonpphoto_api_user=this.webpackJsonpphoto_api_user||[]).push([[0],{52:function(e,t,a){},53:function(e,t,a){},75:function(e,t,a){"use strict";a.r(t);var r=a(1),n=a.n(r),c=a(26),o=a.n(c),s=a(18),i=a(27),l={user_id:localStorage.getItem("user_id")?localStorage.getItem("user_id"):null,email:null,token:localStorage.getItem("token")?localStorage.getItem("token"):null},u=Object(i.b)({name:"user",initialState:l,reducers:{setUser:function(e,t){e.user_id=t.payload.id,e.email=t.payload.email,e.token=t.payload.token,localStorage.setItem("user_id",e.user_id||""),localStorage.setItem("token",e.token||"")},removeUser:function(e){e.user_id=null,e.email=null,e.token=null,localStorage.removeItem("user_id"),localStorage.removeItem("token")}}}),j=u.actions,b=j.setUser,p=j.removeUser,d=u.reducer,m=Object(i.a)({reducer:{user:d}}),h=(a(52),a(4)),O=(a(53),a(3)),x=a(5),f=a.n(x),v=a(10),g=a(6),k=a(22),N=a(76),w=a(77),S=a(14),y=a.n(S),_=a(2);function C(){var e,t,a=Object(k.a)({mode:"onBlur"}),n=a.register,c=a.handleSubmit,o=a.formState.errors,i=Object(h.g)(),l=Object(s.b)(),u=Object(r.useState)(""),j=Object(g.a)(u,2),p=j[0],d=j[1],m=Object(r.useState)(""),x=Object(g.a)(m,2),S=x[0],C=x[1],q=Object(r.useState)(""),I=Object(g.a)(q,2),E=I[0],L=I[1],P=function(){var e=Object(v.a)(f.a.mark((function e(){var t,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.a.post("http://webphoto-api.herokuapp.com/users/sign_in",{user:{email:p,password:S}});case 3:t=e.sent,a=t.data,l(b({id:a.user.id,email:a.user.email,token:a.token})),i("/",{replace:!0}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),L(e.t0.response.data.error);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();return Object(_.jsxs)(N.a,{onSubmit:c(P),className:"Own-form",children:[Object(_.jsx)(N.a.Group,{className:"Error-label",children:E}),Object(_.jsxs)(N.a.Group,{className:"mb-3",children:[Object(_.jsx)(N.a.Label,{className:"form-label",children:"Email"}),Object(_.jsx)(N.a.Control,Object(O.a)(Object(O.a)({},n("email",{required:!0})),{},{type:"email",name:"email",value:p,onChange:function(e){return d(e.target.value)},className:"form-control"})),Object(_.jsx)(N.a.Group,{className:"Error-label",children:"required"===(null===o||void 0===o||null===(e=o.email)||void 0===e?void 0:e.type)&&Object(_.jsx)("p",{children:"This field is required"})})]}),Object(_.jsxs)(N.a.Group,{className:"mb-3",children:[Object(_.jsx)(N.a.Label,{className:"form-label",children:"Password"}),Object(_.jsx)(N.a.Control,Object(O.a)(Object(O.a)({},n("password",{required:!0})),{},{type:"password",name:"password",value:S,onChange:function(e){return C(e.target.value)},className:"form-control"})),Object(_.jsx)(N.a.Group,{className:"Error-label",children:"required"===(null===o||void 0===o||null===(t=o.password)||void 0===t?void 0:t.type)&&Object(_.jsx)("p",{children:"This field is required"})})]}),Object(_.jsx)(w.a,{variant:"primary",type:"submit",children:"Submit"})]})}function q(){var e,t,a=Object(k.a)({mode:"onBlur"}),n=a.register,c=a.handleSubmit,o=a.formState.errors,i=Object(h.g)(),l=Object(s.b)(),u=Object(r.useState)(""),j=Object(g.a)(u,2),p=j[0],d=j[1],m=Object(r.useState)(""),x=Object(g.a)(m,2),S=x[0],C=x[1],q=Object(r.useState)(""),I=Object(g.a)(q,2),E=I[0],L=I[1],P=Object(r.useState)(""),A=Object(g.a)(P,2),G=A[0],B=A[1],F=function(){var e=Object(v.a)(f.a.mark((function e(){var t,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.a.post("http://webphoto-api.herokuapp.com/users/",{user:{email:p,password:S,password_confirmation:E}});case 3:t=e.sent,a=t.data,l(b({id:a.user.id,email:a.user.email,token:a.token})),i("/",{replace:!0}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),B(e.t0.response.data.error);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();return Object(_.jsxs)(N.a,{onSubmit:c(F),className:"Own-form",children:[Object(_.jsx)(N.a.Group,{className:"Error-label",children:G}),Object(_.jsxs)(N.a.Group,{className:"mb-3",children:[Object(_.jsx)(N.a.Label,{className:"form-label",children:"Email"}),Object(_.jsx)(N.a.Control,Object(O.a)(Object(O.a)({},n("email",{required:!0})),{},{type:"email",name:"email",value:p,onChange:function(e){return d(e.target.value)},className:"form-control"})),Object(_.jsx)(N.a.Group,{className:"Error-label",children:"required"===(null===o||void 0===o||null===(e=o.email)||void 0===e?void 0:e.type)&&Object(_.jsx)("p",{children:"Email is required"})})]}),Object(_.jsxs)(N.a.Group,{className:"mb-3",children:[Object(_.jsx)(N.a.Label,{className:"form-label",children:"Password"}),Object(_.jsx)(N.a.Control,Object(O.a)(Object(O.a)({},n("password",{required:!0})),{},{type:"password",name:"password",value:S,onChange:function(e){return C(e.target.value)},className:"form-control"})),Object(_.jsx)(N.a.Group,{className:"Error-label",children:"required"===(null===o||void 0===o||null===(t=o.password)||void 0===t?void 0:t.type)&&Object(_.jsx)("p",{children:"Password is required"})})]}),Object(_.jsxs)(N.a.Group,{className:"mb-3",children:[Object(_.jsx)(N.a.Label,{className:"form-label",children:"Password confirmation"}),Object(_.jsx)(N.a.Control,{type:"password",name:"password_confirmation",value:E,onChange:function(e){return L(e.target.value)},className:"form-control"})]}),Object(_.jsx)(w.a,{variant:"primary",type:"submit",children:"Submit"})]})}function I(){var e=Object(s.c)((function(e){return e.user})),t=e.user_id,a=e.email,r=e.token;return{isAuth:!!r,user_id:t,email:a,token:r}}var E=function(e){var t,a=I().isAuth,n=Object(k.a)({mode:"onBlur"}),c=n.register,o=n.handleSubmit,s=n.formState.errors,i=Object(r.useState)(""),l=Object(g.a)(i,2),u=l[0],j=l[1],b=Object(r.useState)(new Blob),p=Object(g.a)(b,2),d=p[0],m=p[1],h=function(){var t=Object(v.a)(f.a.mark((function t(){var a,r;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(a=new FormData).append("name",u),a.append("image",d),t.prev=3,t.next=6,y.a.post("http://webphoto-api.herokuapp.com/api/v1/photos",a,{headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")}});case 6:r=t.sent,e.updatePhotoList(r.data),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(3),console.log(t.t0.response.message);case 13:case"end":return t.stop()}}),t,null,[[3,10]])})));return function(){return t.apply(this,arguments)}}();return Object(_.jsx)("div",{children:a?Object(_.jsxs)(N.a,{onSubmit:o(h),className:"Own-form",children:[Object(_.jsxs)(N.a.Label,{className:"form-label",children:["Name",Object(_.jsx)(N.a.Control,Object(O.a)(Object(O.a)({},c("name",{required:!0})),{},{id:"name_input",className:"form-control",type:"text",name:"name",onChange:function(e){return j(e.target.value)}}))]}),Object(_.jsx)(N.a.Group,{className:"Error-label",children:"required"===(null===s||void 0===s||null===(t=s.name)||void 0===t?void 0:t.type)&&Object(_.jsx)("p",{children:"This field is required"})}),Object(_.jsx)(N.a.Label,{className:"form-label",children:Object(_.jsx)(N.a.Control,Object(O.a)(Object(O.a)({},c("image",{required:!0})),{},{id:"image_input",className:"form-control",type:"file",name:"image",onChange:function(e){e.target.files&&m(e.target.files[0])}}))}),Object(_.jsx)("br",{}),Object(_.jsx)("br",{}),Object(_.jsx)(w.a,{variant:"primary",type:"submit",children:"Submit"})]}):Object(_.jsx)(_.Fragment,{})})},L=a(42),P=a(30);function A(e){var t=Object(r.useState)(!1),a=Object(g.a)(t,2),n=a[0],c=a[1],o=Object(r.useState)(e.photo.likes_count),s=Object(g.a)(o,2),i=s[0],l=s[1];Object(r.useEffect)((function(){console.log(e),y.a.get("http://webphoto-api.herokuapp.com"+"/api/v1/photos/".concat(e.photo.id,"/like_status"),{headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")}}).then((function(e){return e.data})).then((function(e){c(e.status)})).catch((function(e){return console.log(e.response)}))}),[]);var u=function(t){y.a.post("http://webphoto-api.herokuapp.com"+"/api/v1/photos/".concat(e.photo.id,"/likes"),null,{headers:t}).then((function(e){c(!0),l(i+1)})).catch((function(e){return console.log(e.response.data.error)}))},j=function(t){y.a.delete("http://webphoto-api.herokuapp.com"+"/api/v1/photos/".concat(e.photo.id,"/likes"),{headers:t}).then((function(){c(!1),l(i-1)})).catch((function(e){return console.log(e.response.data.error)}))};return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("button",{onClick:function(){c(!n);var e={"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")};n?j(e):u(e)},className:"Like-button",children:n?Object(_.jsx)(P.a,{}):Object(_.jsx)(P.b,{})}),i]})}function G(e){var t=I().user_id;return Object(_.jsxs)("div",{className:"card",children:[t==e.photo.user_id?Object(_.jsx)("button",{className:"Photo-delete-button",onClick:function(){window.confirm("Are you sure?")&&e.deletePhoto(e.photo)},children:Object(_.jsx)(L.a,{size:20})}):Object(_.jsx)("div",{}),Object(_.jsx)("img",{className:"card-img-top",src:"http://webphoto-api.herokuapp.com"+"/".concat(e.photo.image)}),Object(_.jsxs)("div",{className:"card-body",children:[Object(_.jsx)("p",{className:"card-text",children:e.photo.name}),Object(_.jsx)(A,{photo:e.photo})]})]})}function B(){var e=Object(h.g)(),t=Object(r.useState)([]),a=Object(g.a)(t,2),n=a[0],c=a[1],o=I().user_id,s=Object(h.h)();Object(r.useEffect)((function(){l()}),[]);var i=function(){return{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")}},l=function(){var e=Object(v.a)(f.a.mark((function e(){var t,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.a.get("http://webphoto-api.herokuapp.com/api/v1/photos",{params:{user_id:s.user_id?s.user_id:o},headers:i()});case 3:t=e.sent,a=t.data,c(a.reverse()),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),u=function(e){var t=n,a=t.indexOf(e);t.splice(a,1),c(t)},j=function(){var t=Object(v.a)(f.a.mark((function t(a){var r;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,y.a.delete("http://webphoto-api.herokuapp.com"+"/api/v1/photos/".concat(a.id),{headers:i()});case 3:r=t.sent,console.log(r),u(a),e("/",{replace:!0}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.log(t.t0.response.data.error);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}();return Object(_.jsxs)("div",{children:[Object(_.jsx)("div",{children:Object(_.jsx)(E,{updatePhotoList:function(t){var a=n;a.unshift(t),c(a),e("/",{replace:!0})}})}),Object(_.jsx)("div",{className:"Photo-list",children:n.map((function(e){return Object(_.jsx)(G,{photo:e,deletePhoto:j},e.id)}))})]})}function F(){return Object(_.jsx)("div",{children:Object(_.jsx)(B,{})})}function T(){return Object(_.jsx)("div",{children:Object(_.jsx)("h1",{children:"404 Not Found"})})}var z=a(16),U=function(){var e=Object(s.b)(),t=Object(h.g)(),a=I().isAuth;return Object(_.jsx)("div",{className:"container",children:Object(_.jsxs)("nav",{className:"navbar",children:[Object(_.jsx)(z.b,{to:"/",className:"App-logo",children:"Photo Api"}),a?Object(_.jsx)("div",{className:"nav-btn d-flex",children:Object(_.jsx)("button",{onClick:function(){e(p()),t("/",{replace:!0})},className:"btn btn-outline-primary me-2",children:"Log Out"})}):Object(_.jsxs)("div",{className:"nav-btn d-flex",children:[Object(_.jsx)(z.b,{to:"/sign_up",className:"btn btn-outline-primary me-2",children:"Sign Up"}),Object(_.jsx)(z.b,{to:"/sign_in",className:"btn btn-primary",children:"Sign In"})]})]})})};function D(){return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(U,{}),Object(_.jsx)("main",{className:"container",children:Object(_.jsx)(h.a,{})})]})}var J=function(){var e=I().isAuth;return Object(_.jsx)("div",{className:"App",children:Object(_.jsx)(h.d,{children:Object(_.jsxs)(h.b,{path:"/",element:Object(_.jsx)(D,{}),children:[Object(_.jsx)(h.b,{index:!0,element:Object(_.jsx)(F,{})}),!e&&Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(h.b,{path:"sign_in",element:Object(_.jsx)(C,{})}),Object(_.jsx)(h.b,{path:"sign_up",element:Object(_.jsx)(q,{})})]}),Object(_.jsx)(h.b,{path:"photos/:user_id",element:Object(_.jsx)(B,{})}),Object(_.jsx)(h.b,{path:"*",element:Object(_.jsx)(T,{})})]})})})},M=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,78)).then((function(t){var a=t.getCLS,r=t.getFID,n=t.getFCP,c=t.getLCP,o=t.getTTFB;a(e),r(e),n(e),c(e),o(e)}))};a(74);o.a.render(Object(_.jsx)(n.a.StrictMode,{children:Object(_.jsx)(s.a,{store:m,children:Object(_.jsx)(z.a,{children:Object(_.jsx)(J,{})})})}),document.getElementById("root")),M()}},[[75,1,2]]]);
//# sourceMappingURL=main.9b4ca967.chunk.js.map